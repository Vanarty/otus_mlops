# ДЗ № 3. Анализ качества и очистка датасета мошеннических финансовых операций

## План домашнего задания

1. Создать инфраструктуру в Yandex.Cloud с помощью Terraform 
   1. Сервисный аккаунт
   2. Сеть
   3. Объектное хранилище S3
   4. Dataproc кластер
   5. ВМ для доступа к кластеру
 
2. Загрузить все данные из учебного бакета в HDFS
3. Запустить на мастер-ноде кластера jupyter-notebook. Провести анализ данных, сформировать шаги по предобработке данных, включая возможную очистку.
4. Написать скрипт, который должен автоматически провести препроцессинг данных из шага 3 и загрузить очищенные данные в виде parquet-файлов в целевой бакет.

## Выполнение

1. Весь необходимый манифест создан. Добавлены свои настройки в файл terraforms.tfvars.
Создан следующий кластер под объем сырых данных в 100+ Гб:
* одна мастер-нода: s3-c2-m8, 50 Гб SSD;
* три compute-ноды: s3-c4-m16, 50 Гб SSD на одну ноду;
* три data-ноды: s3-c4-m16, 100 Гб SSD на одну ноду.

Стоимость общей конфигурации около 73 руб./час.

2. Данные автоматически загружены в HDFS после подъема инфраструктуры (скрипт scripts/upload_data_to_hdfs.sh). 

3. Для работы с jupyter ноутбуком на мастер-ноде превадрительно проброшен порт 8888 по ssh через прокси виртуальную машину. `ssh -L 8888:localhost:8888 ubuntu@<ip proxy>` -> `ssh -L 8888:localhost:8888 ubuntu@<ip master-ноды>`. 

При анализе данных обнаружено:

* Все исходные данные в text формате и требуют предобработки для приведения к табличному виду;
* Ошибка в названии колонки `tranaction_id`. Пропущена буква **s**;
* Есть пропуски в колонке `terminal_id` 36643 пропусков. Так как всего в данных почти в 1,7 млрд. записей такой объем пропусков не существенен и такие записи можно удалить;
* Данные необходимо удалить от возможных дублей по колонке `transaction_id`.

Ноутбук с анализом приложен: **data-analys.ipynb**.

4. Данные загружены в целевой бакет автоматически с помощью скрипта после их предобработки (scripts/prepare_data_and_save_to_bucket.py). 
Бакет, куда были загружены файлы -> https://storage.yandexcloud.net/otus-bucket-b1g7tkp18f4l17b9fn7d. 
